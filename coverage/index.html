<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Em-shorty</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.4.4/jquery-1.4.2.min.js' type='text/javascript'></script>
    <script src='./assets/0.4.4/jquery.dataTables.min.js' type='text/javascript'></script>   
    <script src='./assets/0.4.4/fancybox/jquery.fancybox-1.3.1.pack.js' type='text/javascript'></script>   
    <script src='./assets/0.4.4/jquery.timeago.js' type='text/javascript'></script>   
    <script src='./assets/0.4.4/jquery.url.js' type='text/javascript'></script>   
    <script src='./assets/0.4.4/app.js' type='text/javascript'></script>    
    <link href='./assets/0.4.4/stylesheet.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.4.4/fancybox/jquery.fancybox-1.3.1.css' media='screen, projection, print' rel='stylesheet' type='text/css'>
    <link href='./assets/0.4.4/smoothness/jquery-ui-1.8.4.custom.css' media='screen, projection, print' rel='stylesheet' type='text/css'>    
    <link rel="shortcut icon" type="image/png" href="./assets/0.4.4/favicon.png" />
    <link rel="icon" type="image/png" href="./assets/0.4.4/favicon.png" />
  </head>
  
  <body>
    <div id="loading">
      <img src="./assets/0.4.4/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" style="display:none;">
      <div class="timestamp">Generated <abbr class="timeago" title="2011-05-09T02:44:39-07:00">2011-05-09T02:44:39-07:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    All Files
    (<span class="green">98.08%</span>)
  </h2>
  <a name="AllFiles"></a>
  <div>
    <b>4</b> files in total.
    <b>156</b> relevant lines. 
    <span class="green"><b>153</b> lines covered</span> and
    <span class="red"><b>3</b> lines missed </span>
  </div>
  <table class="file_list">
    <thead>
      <tr>
        <th>File</th>
        <th>% covered</th>
        <th>Lines</th>
        <th>Relevant Lines</th>
        <th>Lines covered</th>
        <th>Lines missed</th>
      </tr>
    </thead>
    <tbody>
      
      <tr>
        <td><a href="#700607bbe70192b61214639a9ebb0e451f25f3b5" class="src_link" title="./lib/cache_proxy.rb">./lib/cache_proxy.rb</a></td>
        <td class="green">100.0 %</td>
        <td>12</td>
        <td>4</td>
        <td>4</td>
        <td>0</td>
      </tr>
      
      <tr>
        <td><a href="#7f5dc5e0e81dc1e0fe3f383cfe48f38e4661be43" class="src_link" title="./lib/hashify.rb">./lib/hashify.rb</a></td>
        <td class="green">100.0 %</td>
        <td>47</td>
        <td>22</td>
        <td>22</td>
        <td>0</td>
      </tr>
      
      <tr>
        <td><a href="#e694f285bf494d501abc8ac8788d18ec798d6394" class="src_link" title="./lib/shortened_url.rb">./lib/shortened_url.rb</a></td>
        <td class="green">100.0 %</td>
        <td>73</td>
        <td>32</td>
        <td>32</td>
        <td>0</td>
      </tr>
      
      <tr>
        <td><a href="#1409cadf89cec1fb8a0af5a17da83e83a7bb2d73" class="src_link" title="./shorty_app.rb">./shorty_app.rb</a></td>
        <td class="green">96.94 %</td>
        <td>167</td>
        <td>98</td>
        <td>95</td>
        <td>3</td>
      </tr>
      
    </tbody>
  </table>
</div>

        
      </div>
    
      <div id="footer">
        Generated by <a href="http://github.com/colszowka/simplecov">simplecov</a> v0.4.2 
        and simplecov-html v0.4.4<br/>
        using Unit Tests
      </div>
    
      <div class="source_files">
      
        <div class="source_table" id="700607bbe70192b61214639a9ebb0e451f25f3b5">
  <table>
    <thead>
    <tr>
      <td colspan="3">
        <h3>./lib/cache_proxy.rb</h3>
        <h4><span class="green">100.0 %</span> covered</h4>
      </td>
    </tr>
    <tr>
      <th>#</th>
      <th></th>
      <th>Hits</th>
    </tr>
    </thead>
    <tbody>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>1</pre>
      </td>
      <td>
        <pre># Simple way to turn the cache on and off</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>2</pre>
      </td>
      <td>
        <pre># and keep your code clean.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>3</pre>
      </td>
      <td>
        <pre>class CacheProxy</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>4</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>5</pre>
      </td>
      <td>
        <pre>  def fetch(*args, &amp;block)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>6</pre>
      </td>
      <td>
        <pre>    block.call</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>7</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>8</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>9</pre>
      </td>
      <td>
        <pre>  def flush(*args)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>10</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>11</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>12</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    </tbody>
  </table>
</div>
      
        <div class="source_table" id="7f5dc5e0e81dc1e0fe3f383cfe48f38e4661be43">
  <table>
    <thead>
    <tr>
      <td colspan="3">
        <h3>./lib/hashify.rb</h3>
        <h4><span class="green">100.0 %</span> covered</h4>
      </td>
    </tr>
    <tr>
      <th>#</th>
      <th></th>
      <th>Hits</th>
    </tr>
    </thead>
    <tbody>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>1</pre>
      </td>
      <td>
        <pre># Add popular hashing functions to strings.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>2</pre>
      </td>
      <td>
        <pre># Then wrap in a nice hashify method.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>3</pre>
      </td>
      <td>
        <pre>module Hashify</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>4</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>5</pre>
      </td>
      <td>
        <pre>  VALID_FORMATS = [:md5, :sha1, :sha2]</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>6</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>7</pre>
      </td>
      <td>
        <pre>  def self.included(included_class)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>8</pre>
      </td>
      <td>
        <pre>    included_class.class_eval do</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>9</pre>
      </td>
      <td>
        <pre>      def self.default_hash</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="37">
      <td class="line_number">
        <pre>10</pre>
      </td>
      <td>
        <pre>        @@default_hash ||= :sha1</pre>
      </td>
      <td class="hits">
        37
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>11</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>12</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>13</pre>
      </td>
      <td>
        <pre>      def self.default_hash=(format)</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>14</pre>
      </td>
      <td>
        <pre>        @@default_hash = format if VALID_FORMATS.include?(format)</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>15</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>16</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>17</pre>
      </td>
      <td>
        <pre>      def hashify(format = self.class.default_hash)</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="67">
      <td class="line_number">
        <pre>18</pre>
      </td>
      <td>
        <pre>        self.send(&quot;to_#{format}&quot;) if VALID_FORMATS.include?(format)</pre>
      </td>
      <td class="hits">
        67
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>19</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>20</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>21</pre>
      </td>
      <td>
        <pre>      def to_md5</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="18">
      <td class="line_number">
        <pre>22</pre>
      </td>
      <td>
        <pre>        Digest::MD5.hexdigest(self.to_s)</pre>
      </td>
      <td class="hits">
        18
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>23</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>24</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>25</pre>
      </td>
      <td>
        <pre>      def to_sha1</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="49">
      <td class="line_number">
        <pre>26</pre>
      </td>
      <td>
        <pre>        Digest::SHA1.hexdigest(self.to_s)</pre>
      </td>
      <td class="hits">
        49
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>27</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>28</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>29</pre>
      </td>
      <td>
        <pre>      def to_sha2</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="12">
      <td class="line_number">
        <pre>30</pre>
      </td>
      <td>
        <pre>        Digest::SHA2.hexdigest(self.to_s)</pre>
      </td>
      <td class="hits">
        12
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>31</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>32</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>33</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>34</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>35</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>36</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>37</pre>
      </td>
      <td>
        <pre>class String</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>38</pre>
      </td>
      <td>
        <pre>  include Hashify</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>39</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>40</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>41</pre>
      </td>
      <td>
        <pre>class Array</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>42</pre>
      </td>
      <td>
        <pre>  include Hashify</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>43</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>44</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>45</pre>
      </td>
      <td>
        <pre>class Hash</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>46</pre>
      </td>
      <td>
        <pre>  include Hashify</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>47</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    </tbody>
  </table>
</div>
      
        <div class="source_table" id="e694f285bf494d501abc8ac8788d18ec798d6394">
  <table>
    <thead>
    <tr>
      <td colspan="3">
        <h3>./lib/shortened_url.rb</h3>
        <h4><span class="green">100.0 %</span> covered</h4>
      </td>
    </tr>
    <tr>
      <th>#</th>
      <th></th>
      <th>Hits</th>
    </tr>
    </thead>
    <tbody>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>1</pre>
      </td>
      <td>
        <pre># Class to store necessary info for shortening. </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>2</pre>
      </td>
      <td>
        <pre># Just a url to shorten, and an id. so simple.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>3</pre>
      </td>
      <td>
        <pre>class ShortenedUrl &lt; ActiveRecord::Base</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>4</pre>
      </td>
      <td>
        <pre>  attr_accessor :valid_url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>5</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>6</pre>
      </td>
      <td>
        <pre>  validates_presence_of :url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>7</pre>
      </td>
      <td>
        <pre>  validates_uniqueness_of :url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>8</pre>
      </td>
      <td>
        <pre>  validates_presence_of :valid_url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>9</pre>
      </td>
      <td>
        <pre>    </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>10</pre>
      </td>
      <td>
        <pre>  before_validation :validate_url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>11</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>12</pre>
      </td>
      <td>
        <pre>  # Make sure we have a sane url</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>13</pre>
      </td>
      <td>
        <pre>  def validate_url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="52">
      <td class="line_number">
        <pre>14</pre>
      </td>
      <td>
        <pre>    uri = self.class.parse_url(self.url)</pre>
      </td>
      <td class="hits">
        52
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="52">
      <td class="line_number">
        <pre>15</pre>
      </td>
      <td>
        <pre>    if uri &amp;&amp; uri.normalized_scheme &amp;&amp; uri.normalized_host</pre>
      </td>
      <td class="hits">
        52
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="42">
      <td class="line_number">
        <pre>16</pre>
      </td>
      <td>
        <pre>      if uri.normalized_host.match(/\.[a-zA-Z][a-zA-Z]/)</pre>
      </td>
      <td class="hits">
        42
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="40">
      <td class="line_number">
        <pre>17</pre>
      </td>
      <td>
        <pre>        self.url = uri.to_s</pre>
      </td>
      <td class="hits">
        40
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="40">
      <td class="line_number">
        <pre>18</pre>
      </td>
      <td>
        <pre>        self.valid_url = true</pre>
      </td>
      <td class="hits">
        40
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>19</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>20</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>21</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>22</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>23</pre>
      </td>
      <td>
        <pre>  # Shortens an ID by using alphadecimal format (base62)</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>24</pre>
      </td>
      <td>
        <pre>  def shorten</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="50">
      <td class="line_number">
        <pre>25</pre>
      </td>
      <td>
        <pre>    self.id.alphadecimal</pre>
      </td>
      <td class="hits">
        50
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>26</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>27</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>28</pre>
      </td>
      <td>
        <pre>  # Total access count of all api requests and redirects</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>29</pre>
      </td>
      <td>
        <pre>  def total_count</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="34">
      <td class="line_number">
        <pre>30</pre>
      </td>
      <td>
        <pre>    redirect_count + json_count + xml_count + yaml_count</pre>
      </td>
      <td class="hits">
        34
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>31</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>32</pre>
      </td>
      <td>
        <pre>  alias :count :total_count</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>33</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>34</pre>
      </td>
      <td>
        <pre>  # Hash supplied for api hits</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>35</pre>
      </td>
      <td>
        <pre>  def to_api(base_url = nil)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>36</pre>
      </td>
      <td>
        <pre>    { :url =&gt; url, </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>37</pre>
      </td>
      <td>
        <pre>      :short_url =&gt; &quot;#{base_url}/#{shorten}&quot;,</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>38</pre>
      </td>
      <td>
        <pre>      :json_count =&gt; json_count,</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>39</pre>
      </td>
      <td>
        <pre>      :xml_count =&gt; xml_count,</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>40</pre>
      </td>
      <td>
        <pre>      :yaml_count =&gt; yaml_count,</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>41</pre>
      </td>
      <td>
        <pre>      :redirect_count =&gt; redirect_count,</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="18">
      <td class="line_number">
        <pre>42</pre>
      </td>
      <td>
        <pre>      :total_count =&gt; total_count }</pre>
      </td>
      <td class="hits">
        18
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>43</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>44</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>45</pre>
      </td>
      <td>
        <pre>  # Find url by its alphadecimal value</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>46</pre>
      </td>
      <td>
        <pre>  def self.find_by_shortened(shortened)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="9">
      <td class="line_number">
        <pre>47</pre>
      </td>
      <td>
        <pre>    find(shortened.alphadecimal)</pre>
      </td>
      <td class="hits">
        9
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>48</pre>
      </td>
      <td>
        <pre>  rescue ActiveRecord::RecordNotFound</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>49</pre>
      </td>
      <td>
        <pre>    nil</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>50</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>51</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>52</pre>
      </td>
      <td>
        <pre>  def self.find_by_url(url)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="33">
      <td class="line_number">
        <pre>53</pre>
      </td>
      <td>
        <pre>    find(:first, :conditions =&gt; {:url =&gt; normalize_url(url)})</pre>
      </td>
      <td class="hits">
        33
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>54</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>55</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>56</pre>
      </td>
      <td>
        <pre>  def self.find_or_create_by_url(url)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="19">
      <td class="line_number">
        <pre>57</pre>
      </td>
      <td>
        <pre>    ret_url = find_by_url(url)</pre>
      </td>
      <td class="hits">
        19
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="19">
      <td class="line_number">
        <pre>58</pre>
      </td>
      <td>
        <pre>    ret_url ||= self.create(:url =&gt; url)</pre>
      </td>
      <td class="hits">
        19
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>59</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>60</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>61</pre>
      </td>
      <td>
        <pre>  # Real url for our system. Everything is filtered.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>62</pre>
      </td>
      <td>
        <pre>  def self.normalize_url(url)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="35">
      <td class="line_number">
        <pre>63</pre>
      </td>
      <td>
        <pre>    parse_url(url).to_s</pre>
      </td>
      <td class="hits">
        35
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>64</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>65</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>66</pre>
      </td>
      <td>
        <pre>  protected</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>67</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>68</pre>
      </td>
      <td>
        <pre>  # Use addressable to parse the url</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>69</pre>
      </td>
      <td>
        <pre>  def self.parse_url(url)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="89">
      <td class="line_number">
        <pre>70</pre>
      </td>
      <td>
        <pre>    Addressable::URI.heuristic_parse(url).normalize rescue nil</pre>
      </td>
      <td class="hits">
        89
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>71</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>72</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>73</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    </tbody>
  </table>
</div>
      
        <div class="source_table" id="1409cadf89cec1fb8a0af5a17da83e83a7bb2d73">
  <table>
    <thead>
    <tr>
      <td colspan="3">
        <h3>./shorty_app.rb</h3>
        <h4><span class="green">96.94 %</span> covered</h4>
      </td>
    </tr>
    <tr>
      <th>#</th>
      <th></th>
      <th>Hits</th>
    </tr>
    </thead>
    <tbody>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>1</pre>
      </td>
      <td>
        <pre># em-shorty 0.5.0</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>2</pre>
      </td>
      <td>
        <pre># By: Josh Ellithorpe April 2011</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>3</pre>
      </td>
      <td>
        <pre># URL shortner that uses rack fiber pool for optimal performance.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>4</pre>
      </td>
      <td>
        <pre># thin -R config.ru start</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>5</pre>
      </td>
      <td>
        <pre># http://localhost:3000/</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>6</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>7</pre>
      </td>
      <td>
        <pre># Raise an error if we don't have a compatible ruby version.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>8</pre>
      </td>
      <td>
        <pre>raise LoadError, 'Ruby 1.9.2 required' if RUBY_VERSION &lt; '1.9.2'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>9</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>10</pre>
      </td>
      <td>
        <pre># Add lib directory to load path</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>11</pre>
      </td>
      <td>
        <pre>$LOAD_PATH &lt;&lt; File.join(File.dirname(__FILE__), 'lib')</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>12</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>13</pre>
      </td>
      <td>
        <pre># Require needed libs</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>14</pre>
      </td>
      <td>
        <pre>require 'fiber'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>15</pre>
      </td>
      <td>
        <pre>require 'rack/fiber_pool'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>16</pre>
      </td>
      <td>
        <pre>require 'sinatra'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>17</pre>
      </td>
      <td>
        <pre>require 'sinatra/activerecord'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>18</pre>
      </td>
      <td>
        <pre>require 'sinatra/i18n'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>19</pre>
      </td>
      <td>
        <pre>require 'alphadecimal'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>20</pre>
      </td>
      <td>
        <pre>require 'less'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>21</pre>
      </td>
      <td>
        <pre>require 'shortened_url'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>22</pre>
      </td>
      <td>
        <pre>require 'cache_proxy'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>23</pre>
      </td>
      <td>
        <pre>require 'resolv'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>24</pre>
      </td>
      <td>
        <pre>require 'mime/types'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>25</pre>
      </td>
      <td>
        <pre>require 'dalli'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>26</pre>
      </td>
      <td>
        <pre>require 'hashify'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>27</pre>
      </td>
      <td>
        <pre>require 'em-synchrony/em-http'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>28</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>29</pre>
      </td>
      <td>
        <pre># Conditional require's based on environment.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>30</pre>
      </td>
      <td>
        <pre>require 'em-resolv-replace' unless test?</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>31</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>32</pre>
      </td>
      <td>
        <pre># Make home page respond to both get and post.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>33</pre>
      </td>
      <td>
        <pre>def home(url, verbs = %w(get post), &amp;block)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>34</pre>
      </td>
      <td>
        <pre>  verbs.each do |verb|</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="2">
      <td class="line_number">
        <pre>35</pre>
      </td>
      <td>
        <pre>    send(verb, url, &amp;block)</pre>
      </td>
      <td class="hits">
        2
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>36</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>37</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>38</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>39</pre>
      </td>
      <td>
        <pre># Main application class.</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>40</pre>
      </td>
      <td>
        <pre>class ShortyApp &lt; Sinatra::Base</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>41</pre>
      </td>
      <td>
        <pre>  set :root, File.dirname(__FILE__)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>42</pre>
      </td>
      <td>
        <pre>  set :locales, File.join(File.dirname(__FILE__), 'config', 'en.yml')</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>43</pre>
      </td>
      <td>
        <pre>  set :api_formats, [:json, :xml, :yaml]</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>44</pre>
      </td>
      <td>
        <pre>  set :memcached, 'localhost:11211'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>45</pre>
      </td>
      <td>
        <pre>  set :sockets, ['/opt/local/var/run/mysql5/mysqld.sock', </pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>46</pre>
      </td>
      <td>
        <pre>                  '/var/run/mysqld/mysqld.sock', </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>47</pre>
      </td>
      <td>
        <pre>                  '/tmp/mysql.sock']</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>48</pre>
      </td>
      <td>
        <pre>  set :caching, true</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>49</pre>
      </td>
      <td>
        <pre>  set :cache_timeout, 120</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>50</pre>
      </td>
      <td>
        <pre>  set :cache, settings.caching ? Dalli::Client.new(settings.memcached, {:namespace =&gt; 'shorty_', :expires_in =&gt; settings.cache_timeout}) : CacheProxy.new()</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>51</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>52</pre>
      </td>
      <td>
        <pre>  use Rack::FiberPool, :size =&gt; 100 unless test?</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>53</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>54</pre>
      </td>
      <td>
        <pre>  register Sinatra::I18n</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>55</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>56</pre>
      </td>
      <td>
        <pre>  configure do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>57</pre>
      </td>
      <td>
        <pre>    db_config = YAML.load_file(File.join('config', 'database.yml'))[settings.environment.to_s]</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>58</pre>
      </td>
      <td>
        <pre>    db_config.merge!({'socket' =&gt; settings.sockets.find { |f| File.exist? f } }) if db_config['socket']</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>59</pre>
      </td>
      <td>
        <pre>    ActiveRecord::Base.establish_connection(db_config)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>60</pre>
      </td>
      <td>
        <pre>    ActiveRecord::Base.logger.level = Logger::INFO</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>61</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>62</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>63</pre>
      </td>
      <td>
        <pre>  before do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="35">
      <td class="line_number">
        <pre>64</pre>
      </td>
      <td>
        <pre>    set_content_type(params[:format])</pre>
      </td>
      <td class="hits">
        35
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>65</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>66</pre>
      </td>
      <td>
        <pre>    </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>67</pre>
      </td>
      <td>
        <pre>  home '/' do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="25">
      <td class="line_number">
        <pre>68</pre>
      </td>
      <td>
        <pre>    if params[:url]</pre>
      </td>
      <td class="hits">
        25
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="22">
      <td class="line_number">
        <pre>69</pre>
      </td>
      <td>
        <pre>      settings.cache.fetch &quot;shorten_#{request.ip}_#{params[:url]}_#{params[:format]}&quot;.hashify do</pre>
      </td>
      <td class="hits">
        22
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="18">
      <td class="line_number">
        <pre>70</pre>
      </td>
      <td>
        <pre>        @short_url = ShortenedUrl.find_or_create_by_url(params[:url])</pre>
      </td>
      <td class="hits">
        18
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="18">
      <td class="line_number">
        <pre>71</pre>
      </td>
      <td>
        <pre>        format = params[:format]</pre>
      </td>
      <td class="hits">
        18
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="18">
      <td class="line_number">
        <pre>72</pre>
      </td>
      <td>
        <pre>        if @short_url.valid?</pre>
      </td>
      <td class="hits">
        18
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="14">
      <td class="line_number">
        <pre>73</pre>
      </td>
      <td>
        <pre>          if format.blank?</pre>
      </td>
      <td class="hits">
        14
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="8">
      <td class="line_number">
        <pre>74</pre>
      </td>
      <td>
        <pre>            @flash = {:notice =&gt; I18n.translate(:url_shortened, :original_url =&gt; @short_url.url)}</pre>
      </td>
      <td class="hits">
        8
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="8">
      <td class="line_number">
        <pre>75</pre>
      </td>
      <td>
        <pre>            @viewed_url = &quot;#{current_url}/#{@short_url.shorten}&quot;</pre>
      </td>
      <td class="hits">
        8
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="8">
      <td class="line_number">
        <pre>76</pre>
      </td>
      <td>
        <pre>            haml :success</pre>
      </td>
      <td class="hits">
        8
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>77</pre>
      </td>
      <td>
        <pre>          else</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>78</pre>
      </td>
      <td>
        <pre>            if settings.api_formats.include?(format.to_sym)</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>79</pre>
      </td>
      <td>
        <pre>              @short_url.increment!(&quot;#{format}_count&quot;)</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>80</pre>
      </td>
      <td>
        <pre>              erb :api_output, :layout =&gt; false, :locals =&gt; {:api_output =&gt; api_object(@short_url).send(&quot;to_#{format}&quot;)}</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>81</pre>
      </td>
      <td>
        <pre>            end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>82</pre>
      </td>
      <td>
        <pre>          end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>83</pre>
      </td>
      <td>
        <pre>        else</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>84</pre>
      </td>
      <td>
        <pre>          @flash = {:error =&gt; t('enter_valid_url')}</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="4">
      <td class="line_number">
        <pre>85</pre>
      </td>
      <td>
        <pre>          if format.blank?</pre>
      </td>
      <td class="hits">
        4
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>86</pre>
      </td>
      <td>
        <pre>            haml :index</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>87</pre>
      </td>
      <td>
        <pre>          else</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="3">
      <td class="line_number">
        <pre>88</pre>
      </td>
      <td>
        <pre>            if settings.api_formats.include?(format.to_sym)</pre>
      </td>
      <td class="hits">
        3
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="3">
      <td class="line_number">
        <pre>89</pre>
      </td>
      <td>
        <pre>              erb :api_output, :layout =&gt; false, :locals =&gt; {:api_output =&gt; {:error =&gt; @flash[:error]}.send(&quot;to_#{format}&quot;)}</pre>
      </td>
      <td class="hits">
        3
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>90</pre>
      </td>
      <td>
        <pre>            end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>91</pre>
      </td>
      <td>
        <pre>          end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>92</pre>
      </td>
      <td>
        <pre>        end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>93</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>94</pre>
      </td>
      <td>
        <pre>    else</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="3">
      <td class="line_number">
        <pre>95</pre>
      </td>
      <td>
        <pre>      cache_control :public, :must_revalidate, :max_age =&gt; (settings.cache_timeout * 10)</pre>
      </td>
      <td class="hits">
        3
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="3">
      <td class="line_number">
        <pre>96</pre>
      </td>
      <td>
        <pre>      haml :index</pre>
      </td>
      <td class="hits">
        3
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>97</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>98</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>99</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>100</pre>
      </td>
      <td>
        <pre>  get '/main.css' do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>101</pre>
      </td>
      <td>
        <pre>    cache_control :public, :must_revalidate, :max_age =&gt; (settings.cache_timeout * 10)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>102</pre>
      </td>
      <td>
        <pre>    content_type 'text/css', :charset =&gt; 'utf-8'</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>103</pre>
      </td>
      <td>
        <pre>    less :main</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>104</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>105</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>106</pre>
      </td>
      <td>
        <pre>  get '/:shortened.:format' do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>107</pre>
      </td>
      <td>
        <pre>    set_content_type(params[:format])</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>108</pre>
      </td>
      <td>
        <pre>    settings.cache.fetch &quot;view_#{request.ip}_#{params[:shortened]}_#{params[:format]}&quot;.hashify do</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>109</pre>
      </td>
      <td>
        <pre>      format = params[:format]</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>110</pre>
      </td>
      <td>
        <pre>      if settings.api_formats.include?(format.to_sym)</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>111</pre>
      </td>
      <td>
        <pre>        short_url = ShortenedUrl.find_by_shortened(params[:shortened])</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>112</pre>
      </td>
      <td>
        <pre>        if short_url</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="3">
      <td class="line_number">
        <pre>113</pre>
      </td>
      <td>
        <pre>          short_url.increment!(&quot;#{format}_count&quot;)</pre>
      </td>
      <td class="hits">
        3
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="3">
      <td class="line_number">
        <pre>114</pre>
      </td>
      <td>
        <pre>          shorty = api_object(short_url)</pre>
      </td>
      <td class="hits">
        3
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>115</pre>
      </td>
      <td>
        <pre>        else</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="3">
      <td class="line_number">
        <pre>116</pre>
      </td>
      <td>
        <pre>          shorty = {:error =&gt; t('no_record_found')}</pre>
      </td>
      <td class="hits">
        3
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>117</pre>
      </td>
      <td>
        <pre>        end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="6">
      <td class="line_number">
        <pre>118</pre>
      </td>
      <td>
        <pre>        erb :api_output, :layout =&gt; false, :locals =&gt; {:api_output =&gt; shorty.send(&quot;to_#{format}&quot;)}</pre>
      </td>
      <td class="hits">
        6
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>119</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>120</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>121</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>122</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>123</pre>
      </td>
      <td>
        <pre>  get '/:shortened' do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="2">
      <td class="line_number">
        <pre>124</pre>
      </td>
      <td>
        <pre>    settings.cache.fetch &quot;redirect_#{request.ip}_#{params[:shortened]}&quot;.hashify do</pre>
      </td>
      <td class="hits">
        2
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="2">
      <td class="line_number">
        <pre>125</pre>
      </td>
      <td>
        <pre>      return if params[:shortened].index('.')</pre>
      </td>
      <td class="hits">
        2
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="2">
      <td class="line_number">
        <pre>126</pre>
      </td>
      <td>
        <pre>      short_url = ShortenedUrl.find_by_shortened(params[:shortened])</pre>
      </td>
      <td class="hits">
        2
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="2">
      <td class="line_number">
        <pre>127</pre>
      </td>
      <td>
        <pre>      if short_url</pre>
      </td>
      <td class="hits">
        2
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>128</pre>
      </td>
      <td>
        <pre>        short_url.increment!('redirect_count')</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>129</pre>
      </td>
      <td>
        <pre>        redirect short_url.url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>130</pre>
      </td>
      <td>
        <pre>      else</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>131</pre>
      </td>
      <td>
        <pre>        @flash = {:error =&gt; t('no_url')}</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>132</pre>
      </td>
      <td>
        <pre>        haml :index</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>133</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>134</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>135</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>136</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>137</pre>
      </td>
      <td>
        <pre>  not_found do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>138</pre>
      </td>
      <td>
        <pre>    @flash = {:error =&gt; t('http_not_found')}</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>139</pre>
      </td>
      <td>
        <pre>    haml :index</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>140</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>141</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>142</pre>
      </td>
      <td>
        <pre>  error do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="miss" data-hits="0">
      <td class="line_number">
        <pre>143</pre>
      </td>
      <td>
        <pre>    @flash = {:error =&gt; t('http_error')}</pre>
      </td>
      <td class="hits">
        0
      </td>
    </tr>
  
    
    <tr class="miss" data-hits="0">
      <td class="line_number">
        <pre>144</pre>
      </td>
      <td>
        <pre>    haml :index</pre>
      </td>
      <td class="hits">
        0
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>145</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>146</pre>
      </td>
      <td>
        <pre>  </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>147</pre>
      </td>
      <td>
        <pre>  helpers do</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>148</pre>
      </td>
      <td>
        <pre>    def set_content_type(format)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="41">
      <td class="line_number">
        <pre>149</pre>
      </td>
      <td>
        <pre>      if format &amp;&amp; settings.api_formats.include?(format.to_sym)</pre>
      </td>
      <td class="hits">
        41
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="18">
      <td class="line_number">
        <pre>150</pre>
      </td>
      <td>
        <pre>        content_type MIME::Types.of(&quot;format.#{format}&quot;).first.content_type, :charset =&gt; 'utf-8'</pre>
      </td>
      <td class="hits">
        18
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>151</pre>
      </td>
      <td>
        <pre>      end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>152</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>153</pre>
      </td>
      <td>
        <pre>    </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>154</pre>
      </td>
      <td>
        <pre>    def flush_cache</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="miss" data-hits="0">
      <td class="line_number">
        <pre>155</pre>
      </td>
      <td>
        <pre>      settings.cache.flush</pre>
      </td>
      <td class="hits">
        0
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>156</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>157</pre>
      </td>
      <td>
        <pre>    </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>158</pre>
      </td>
      <td>
        <pre>    def current_url</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="17">
      <td class="line_number">
        <pre>159</pre>
      </td>
      <td>
        <pre>      @current_url ||= &quot;#{request.env['rack.url_scheme']}://#{request.env['HTTP_HOST']}&quot;</pre>
      </td>
      <td class="hits">
        17
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>160</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>161</pre>
      </td>
      <td>
        <pre>    </pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="1">
      <td class="line_number">
        <pre>162</pre>
      </td>
      <td>
        <pre>    def api_object(short_url)</pre>
      </td>
      <td class="hits">
        1
      </td>
    </tr>
  
    
    <tr class="hit" data-hits="9">
      <td class="line_number">
        <pre>163</pre>
      </td>
      <td>
        <pre>      short_url.to_api(current_url)</pre>
      </td>
      <td class="hits">
        9
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>164</pre>
      </td>
      <td>
        <pre>    end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>165</pre>
      </td>
      <td>
        <pre>  end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>166</pre>
      </td>
      <td>
        <pre></pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    
    <tr class="never" >
      <td class="line_number">
        <pre>167</pre>
      </td>
      <td>
        <pre>end</pre>
      </td>
      <td class="hits">
        
      </td>
    </tr>
  
    </tbody>
  </table>
</div>
      
      </div>
    </div>
  </body>
</html>
